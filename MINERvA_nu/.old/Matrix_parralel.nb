(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     69691,       1398]
NotebookOptionsPosition[     67336,       1345]
NotebookOutlinePosition[     67891,       1366]
CellTagsIndexPosition[     67848,       1363]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["1. Wczytanie plik\[OAcute]w", "Title",
 CellChangeTimes->{{3.749922505658887*^9, 3.749922520453621*^9}, {
  3.753004796541646*^9, 3.753004798556431*^9}, {3.754567457175824*^9, 
  3.754567492541957*^9}},ExpressionUUID->"df3e8bd5-89f0-4c5c-b0ea-\
a847000923af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "path", "=", "\"\</home/michaszko/Documents/Neutrina/Opus/MINERvA_nu\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"type", "=", "\"\<LFG\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scalingFactor", "=", 
   SuperscriptBox["10", "40"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mecDim", "=", "24"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eventsNumber", "=", 
   RowBox[{"5", "*", 
    SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"crossSection", "=", 
    RowBox[{"1.19718", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "39"}]]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalDelta]p", "T"], "=", 
   RowBox[{"{", 
    RowBox[{
    "75", ",", "75", ",", "100", ",", "75", ",", "75", ",", "75", ",", "75", 
     ",", "150", ",", "150", ",", "150", ",", "250", ",", "250", ",", 
     "1000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dpT", "=", 
   RowBox[{"{", 
    RowBox[{
    "75", ",", "150", ",", "250", ",", "325", ",", "400", ",", "475", ",", 
     "550", ",", "700", ",", "850", ",", "1000", ",", "1250", ",", "1500", 
     ",", "2500"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalDelta]p", "L"], "=", 
   RowBox[{"{", 
    RowBox[{
    "500", ",", "500", ",", "500", ",", "500", ",", "500", ",", "500", ",", 
     "500", ",", "1000", ",", "2000", ",", "2000", ",", "5000", ",", "5000"}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dpL", "=", 
   RowBox[{"{", 
    RowBox[{
    "1500", ",", "2000", ",", "2500", ",", "3000", ",", "3500", ",", "4000", 
     ",", "4500", ",", "5000", ",", "6000", ",", "8000", ",", "10000", ",", 
     "15000", ",", "20000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"widthVanilla", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]p", "T"], ",", 
       SubscriptBox["\[CapitalDelta]p", "L"]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenPT", "=", 
   RowBox[{"Length", "[", 
    SubscriptBox["\[CapitalDelta]p", "T"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lenPL", "=", 
    RowBox[{"Length", "[", 
     SubscriptBox["\[CapitalDelta]p", "L"], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**"}], "*****)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mecVanillaDist", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "path", "<>", "\"\</Data/matrix_\>\"", "<>", "type", "<>", 
     "\"\<.dat\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonmecVanillaMatrix", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "path", "<>", "\"\</Data/cros_total_nuwro_\>\"", "<>", "type", "<>", 
     "\"\<.dat\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"danielVanillaMatrix", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"path", "<>", "\"\</Data/cros_total_daniel.dat\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errorVanillaMatrix", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"path", "<>", "\"\</Data/cros_error_daniel.dat\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covNonVanilla", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"path", "<>", "\"\</Data/daniel_covariance_vanilla.dat\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**"}], "******)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mecDist", "=", 
   RowBox[{
    FractionBox["mecVanillaDist", "eventsNumber"], "*", "crossSection", "*", 
    FractionBox["1000000", "widthVanilla"], "*", 
    FractionBox["12", "13"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errorVanillaMatrixError", " ", "=", " ", 
   RowBox[{"errorVanillaMatrix", "/.", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"y_", "/;", 
       RowBox[{"y", "==", "0"}]}], ")"}], "\[Rule]", "1000000"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covVanilla", "=", 
    RowBox[{"PseudoInverse", "[", "covNonVanilla", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**"}], "*****)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixPlot", "[", 
    RowBox[{"Transpose", "@", "mecDist"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RectangleChart", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[CapitalDelta]p", "T"], ",", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"Plus", "@@", 
             RowBox[{"Transpose", "[", "mecDist", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"-", "1"}], ",", "lenPL"}], "}"}]}], "]"}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BarSpacing", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"lenPT", "-", "1"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPlot", "[", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Plus", "@@", "mecVanillaDist"}], ",", "mecDim"}], "]"}], ",", 
    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.749908061387437*^9, 3.749908083979493*^9}, {
   3.7499082272346277`*^9, 3.7499082929464006`*^9}, {3.749908590819079*^9, 
   3.749908949769373*^9}, {3.749909189530332*^9, 3.749909300711956*^9}, {
   3.749909345030731*^9, 3.749909386831991*^9}, {3.749909423793565*^9, 
   3.7499095481763697`*^9}, {3.749909633067205*^9, 3.749909639701723*^9}, {
   3.749909702176512*^9, 3.749909765092168*^9}, {3.749909826763225*^9, 
   3.749909979372539*^9}, {3.749910023185753*^9, 3.749910024275017*^9}, {
   3.749910056650815*^9, 3.7499101045798492`*^9}, {3.74991015647915*^9, 
   3.7499101870295153`*^9}, {3.7499102921642513`*^9, 3.749910328211569*^9}, {
   3.749910360113841*^9, 3.749910437218906*^9}, {3.7499104942348213`*^9, 
   3.749910499050023*^9}, {3.749910548272904*^9, 3.7499106099525137`*^9}, {
   3.74991065654967*^9, 3.749910658858576*^9}, {3.7499108208455057`*^9, 
   3.7499109864293756`*^9}, {3.74991106260083*^9, 3.749911063473357*^9}, {
   3.749911120804823*^9, 3.749911233483288*^9}, {3.7499112753215647`*^9, 
   3.749911444323502*^9}, {3.749911819617484*^9, 3.7499120172311077`*^9}, {
   3.74991212333911*^9, 3.749912158059705*^9}, {3.7499170955163527`*^9, 
   3.74991713116992*^9}, {3.749917199594757*^9, 3.7499172683163137`*^9}, 
   3.749919008276719*^9, {3.749920102668054*^9, 3.7499201043867607`*^9}, {
   3.749923432427326*^9, 3.749923455927312*^9}, {3.749923933941719*^9, 
   3.7499240041722937`*^9}, {3.749924093911975*^9, 3.749924124031863*^9}, {
   3.7499250144208717`*^9, 3.749925028498217*^9}, 3.750177730059547*^9, {
   3.75017776428021*^9, 3.7501777696067963`*^9}, {3.750178006180161*^9, 
   3.750178015436743*^9}, {3.750178051541*^9, 3.750178070817009*^9}, {
   3.750178130995304*^9, 3.750178131190638*^9}, {3.750182517943487*^9, 
   3.750182518099654*^9}, {3.750182571802265*^9, 3.750182586584333*^9}, {
   3.750326048712327*^9, 3.7503261057234364`*^9}, {3.75032616502773*^9, 
   3.750326242709352*^9}, {3.750326400104376*^9, 3.750326409006576*^9}, {
   3.750326444056559*^9, 3.750326514250051*^9}, {3.750326632143035*^9, 
   3.750326636279573*^9}, {3.75032670161475*^9, 3.7503267210957623`*^9}, {
   3.750326783468165*^9, 3.7503267845042048`*^9}, {3.750326898886434*^9, 
   3.750326899658806*^9}, {3.7503269706349163`*^9, 3.7503269731703463`*^9}, {
   3.75032700433497*^9, 3.7503271334488697`*^9}, {3.750327166321576*^9, 
   3.7503271692390003`*^9}, {3.750327300643441*^9, 3.7503273062206173`*^9}, {
   3.750327355204173*^9, 3.750327369709689*^9}, {3.750327417098057*^9, 
   3.7503275201433153`*^9}, {3.7503277503733873`*^9, 
   3.7503279293228292`*^9}, {3.750327961998065*^9, 3.750328095049563*^9}, {
   3.750328588281891*^9, 3.750328647162911*^9}, {3.750328677282619*^9, 
   3.750328708758814*^9}, {3.750328890987639*^9, 3.75032891540098*^9}, {
   3.750329173147128*^9, 3.75032920818331*^9}, {3.750329294946451*^9, 
   3.750329329416857*^9}, {3.750329785865553*^9, 3.750329806918866*^9}, {
   3.750330863347569*^9, 3.750330878101609*^9}, 3.750338434687747*^9, 
   3.750339238829666*^9, {3.7510366918582163`*^9, 3.7510367064083548`*^9}, {
   3.751036792490362*^9, 3.75103681381312*^9}, 3.7510368517823553`*^9, {
   3.7510369042010117`*^9, 3.751036905175086*^9}, {3.751042409945324*^9, 
   3.751042450099996*^9}, {3.751138727634426*^9, 3.751138733001424*^9}, {
   3.7512148432881193`*^9, 3.7512148552756*^9}, {3.751214898094137*^9, 
   3.751214898404943*^9}, {3.751215088393923*^9, 3.7512151128403482`*^9}, {
   3.7512152141544533`*^9, 3.7512152250225973`*^9}, {3.751215465102317*^9, 
   3.75121548357552*^9}, {3.751734241332014*^9, 3.751734255877267*^9}, {
   3.751735508943685*^9, 3.751735517221944*^9}, {3.75260303851399*^9, 
   3.752603053611925*^9}, {3.75260314078937*^9, 3.7526031808220263`*^9}, {
   3.7526038221228123`*^9, 3.752603826556489*^9}, {3.752604088699609*^9, 
   3.752604091080071*^9}, {3.7527882280681477`*^9, 3.752788234209187*^9}, {
   3.7527889511282578`*^9, 3.752788951810305*^9}, {3.752794908954556*^9, 
   3.752794924773291*^9}, {3.7528715489023542`*^9, 3.752871576394743*^9}, 
   3.75287267475371*^9, {3.7528729365857773`*^9, 3.752872955026205*^9}, 
   3.752873110094221*^9, {3.7528751621992493`*^9, 3.752875204445822*^9}, {
   3.7528760809517183`*^9, 3.752876095583613*^9}, {3.7528761789025*^9, 
   3.7528762011180573`*^9}, {3.752876231765183*^9, 3.752876270820479*^9}, {
   3.7528763145383463`*^9, 3.752876395136711*^9}, 3.7528764853360367`*^9, {
   3.752876533060836*^9, 3.752876568790098*^9}, {3.752876607112624*^9, 
   3.7528766670233183`*^9}, {3.752876712270976*^9, 3.752876779130884*^9}, {
   3.752877174576314*^9, 3.7528772347734957`*^9}, {3.75287728273423*^9, 
   3.752877286151726*^9}, {3.752877603180479*^9, 3.752877643175766*^9}, {
   3.7528777387434397`*^9, 3.7528777398184223`*^9}, {3.7528931261479883`*^9, 
   3.752893306025868*^9}, {3.752893352795154*^9, 3.752893358666292*^9}, {
   3.7528940727860537`*^9, 3.7528940731257277`*^9}, {3.7528941172104053`*^9, 
   3.752894179475132*^9}, {3.752894492163413*^9, 3.752894513020843*^9}, {
   3.752894911248746*^9, 3.752894913609004*^9}, {3.752895122791893*^9, 
   3.752895126227775*^9}, {3.7528951791044903`*^9, 3.752895201307377*^9}, {
   3.752895245032051*^9, 3.752895267167727*^9}, {3.752895374715963*^9, 
   3.752895462428743*^9}, {3.752895523444998*^9, 3.752895528780748*^9}, {
   3.752903608371756*^9, 3.7529036131372547`*^9}, {3.752903654963297*^9, 
   3.7529036863939657`*^9}, {3.7529037253565493`*^9, 3.752903851368474*^9}, {
   3.752903893491935*^9, 3.752904068662607*^9}, {3.752904990672126*^9, 
   3.7529050344334097`*^9}, {3.752905095578146*^9, 3.752905098168841*^9}, {
   3.7529051322025757`*^9, 3.752905141651641*^9}, {3.752905713240213*^9, 
   3.7529057331844397`*^9}, {3.7529071347256193`*^9, 
   3.7529071591513433`*^9}, {3.752907393856838*^9, 3.752907437226099*^9}, {
   3.752907841727771*^9, 3.752907906818091*^9}, {3.752907963176239*^9, 
   3.75290798009813*^9}, {3.7529080163445463`*^9, 3.752908016449291*^9}, {
   3.7529083263032217`*^9, 3.7529084676730547`*^9}, {3.752908942836014*^9, 
   3.7529089450197144`*^9}, {3.7529097716593*^9, 3.752909780930922*^9}, {
   3.752909994070057*^9, 3.7529099950658216`*^9}, {3.752910034111381*^9, 
   3.752910091126087*^9}, {3.75291025377271*^9, 3.752910294692704*^9}, {
   3.752910363639845*^9, 3.752910370931815*^9}, {3.752914624648808*^9, 
   3.752914680346912*^9}, {3.75291486220364*^9, 3.75291517860329*^9}, {
   3.752915233314331*^9, 3.752915260624188*^9}, {3.752915349740036*^9, 
   3.752915350493116*^9}, 3.752915404336948*^9, {3.752915570417789*^9, 
   3.7529155979152603`*^9}, {3.752915723134315*^9, 3.752915732495945*^9}, {
   3.752915958452964*^9, 3.752915958607751*^9}, {3.752916029973679*^9, 
   3.7529160334348907`*^9}, {3.752916228161604*^9, 3.752916245905385*^9}, {
   3.7529165209574127`*^9, 3.752916522970372*^9}, {3.7529166293692636`*^9, 
   3.752916636179419*^9}, {3.752916802792913*^9, 3.7529168067709293`*^9}, {
   3.752917023409596*^9, 3.75291702352466*^9}, {3.75291785501259*^9, 
   3.752917865580533*^9}, {3.752918077131482*^9, 3.7529180776643133`*^9}, {
   3.752918250566625*^9, 3.752918250640216*^9}, {3.752918325084772*^9, 
   3.75291832531717*^9}, {3.752918389291718*^9, 3.752918550397443*^9}, {
   3.752918596167901*^9, 3.7529186433493843`*^9}, {3.7529186935579643`*^9, 
   3.75291869957128*^9}, {3.7529187349022503`*^9, 3.7529187768985043`*^9}, {
   3.752918856436249*^9, 3.752918876843148*^9}, {3.752918921090678*^9, 
   3.7529189260165167`*^9}, {3.752918989650633*^9, 3.752919041276619*^9}, {
   3.7529190720933723`*^9, 3.7529190973994226`*^9}, {3.752920308811489*^9, 
   3.75292031191396*^9}, 3.7529204099509497`*^9, {3.752956884190213*^9, 
   3.752956885639538*^9}, {3.752957130030601*^9, 3.752957140546817*^9}, {
   3.752957175461668*^9, 3.752957186683783*^9}, {3.752957411552526*^9, 
   3.7529574239762173`*^9}, {3.752957500137368*^9, 3.752957580735992*^9}, 
   3.752957949065072*^9, {3.752958334268403*^9, 3.75295845417043*^9}, {
   3.752959720834805*^9, 3.752959738732073*^9}, {3.752959828619753*^9, 
   3.752959837938837*^9}, {3.75295992651126*^9, 3.752959926679781*^9}, 
   3.752960995447566*^9, {3.7529612139980516`*^9, 3.7529612185316133`*^9}, {
   3.752961272719357*^9, 3.752961319596978*^9}, 3.7529613597125483`*^9, 
   3.752961779200405*^9, {3.752962160872097*^9, 3.752962183254593*^9}, {
   3.752962292179434*^9, 3.752962297188347*^9}, {3.7529629200572042`*^9, 
   3.752962924782113*^9}, 3.752963998130628*^9, {3.752964516028644*^9, 
   3.7529645541178417`*^9}, {3.752964838944427*^9, 3.752964880285334*^9}, 
   3.75296533921144*^9, {3.752965519854183*^9, 3.752965593320689*^9}, 
   3.752965669861141*^9, {3.752965850115676*^9, 3.752965857059126*^9}, {
   3.752966633036366*^9, 3.7529666479572477`*^9}, {3.752967389578727*^9, 
   3.7529674759282293`*^9}, {3.7529675069625387`*^9, 3.752967548699065*^9}, {
   3.7529679647687902`*^9, 3.752967991931431*^9}, 3.7529682905203533`*^9, {
   3.752968915959795*^9, 3.7529689253022757`*^9}, {3.752989308322398*^9, 
   3.7529893179705143`*^9}, {3.7529899553126*^9, 3.752989958081991*^9}, {
   3.753000463091694*^9, 3.753000465763474*^9}, {3.753001263457741*^9, 
   3.753001265961392*^9}, {3.753001889163865*^9, 3.753001907352354*^9}, {
   3.753001941534993*^9, 3.753001979314568*^9}, {3.753002018181437*^9, 
   3.7530020564156017`*^9}, 3.753002087057465*^9, {3.7530021405888653`*^9, 
   3.753002145737845*^9}, {3.7530031042809877`*^9, 3.7530031181291447`*^9}, {
   3.753003168869186*^9, 3.753003181039213*^9}, {3.7530033018552027`*^9, 
   3.7530033821793633`*^9}, {3.7530034189036093`*^9, 3.753003439619693*^9}, {
   3.7530035415306587`*^9, 3.753003581767189*^9}, {3.753003629219502*^9, 
   3.7530036421265697`*^9}, 3.753003672172831*^9, 3.753003708033505*^9, 
   3.7530038143391*^9, {3.753003911305904*^9, 3.753003942299199*^9}, {
   3.753004281186969*^9, 3.7530044517968903`*^9}, {3.75300454791077*^9, 
   3.7530045618854017`*^9}, {3.753004692772442*^9, 3.753004728641714*^9}, 
   3.753004785456459*^9, {3.753005055204232*^9, 3.7530050640291233`*^9}, {
   3.7530053073921127`*^9, 3.7530053490760317`*^9}, 3.753005976069601*^9, {
   3.753006056475464*^9, 3.753006057147263*^9}, {3.753006154348435*^9, 
   3.753006170269699*^9}, {3.753006254000031*^9, 3.753006262508582*^9}, {
   3.7530063451089*^9, 3.753006349911098*^9}, {3.753006887278141*^9, 
   3.753006921644973*^9}, {3.753043746917379*^9, 3.753043777133402*^9}, {
   3.7530456726856737`*^9, 3.75304567404416*^9}, {3.7530458402733297`*^9, 
   3.753045863717635*^9}, {3.753046038726635*^9, 3.753046048280287*^9}, {
   3.7530464244296303`*^9, 3.7530464305640383`*^9}, 3.753048973353342*^9, {
   3.753049168641995*^9, 3.753049174959347*^9}, {3.753055177147882*^9, 
   3.75305519472775*^9}, {3.75305546875183*^9, 3.753055469255637*^9}, {
   3.753055567892538*^9, 3.753055583247798*^9}, {3.753055773189671*^9, 
   3.753055780290421*^9}, {3.7530559662886*^9, 3.753056079617494*^9}, {
   3.753087246653895*^9, 3.753087247378788*^9}, {3.753090229387291*^9, 
   3.753090230816098*^9}, {3.753131568149137*^9, 3.753131569909379*^9}, {
   3.75313162509877*^9, 3.753131640822556*^9}, {3.754567495232526*^9, 
   3.754567507582443*^9}, {3.754567578024531*^9, 3.754567697519022*^9}, {
   3.754567784692458*^9, 3.7545678820199337`*^9}, {3.754567924507362*^9, 
   3.754567967918589*^9}, {3.754568007145832*^9, 3.754568077193573*^9}, {
   3.7545681651215477`*^9, 3.754568230859456*^9}, {3.7545682850093307`*^9, 
   3.7545682909249*^9}, {3.754568505914876*^9, 3.75456854848524*^9}, {
   3.7545689563301783`*^9, 3.754568956639682*^9}, {3.754569413923942*^9, 
   3.7545694161989594`*^9}, {3.754585606059558*^9, 3.7545856372251596`*^9}, {
   3.754670428458028*^9, 3.754670460489399*^9}, 3.754671262798152*^9, {
   3.754671302647559*^9, 3.754671383078104*^9}, 3.754671425161166*^9, 
   3.754671649115447*^9, 3.754672955550601*^9, {3.7548450177533827`*^9, 
   3.754845024521226*^9}, 3.7548450561772823`*^9, {3.754845091503718*^9, 
   3.754845314378034*^9}, {3.754845455718445*^9, 3.754845460746194*^9}, {
   3.754845518323039*^9, 3.754845622105255*^9}, {3.7548457283222103`*^9, 
   3.754845786979301*^9}, 3.754845824098486*^9, {3.755016496434177*^9, 
   3.755016499515716*^9}, {3.755016560776648*^9, 3.755016560921444*^9}, {
   3.755016600740443*^9, 3.755016611499955*^9}, {3.7550167781724443`*^9, 
   3.755016783699037*^9}, 3.755018043444697*^9, {3.755020233681814*^9, 
   3.755020241909089*^9}, {3.755689424510559*^9, 3.755689578722927*^9}, {
   3.7556896167189827`*^9, 3.755689620160404*^9}, {3.7556896554829473`*^9, 
   3.7556899091899242`*^9}, {3.7556900026557217`*^9, 
   3.7556900715657587`*^9}, {3.755690166575034*^9, 3.755690194994338*^9}, {
   3.7556902357623672`*^9, 3.75569025723412*^9}, {3.7556904870872993`*^9, 
   3.7556906129471292`*^9}, {3.755690825355571*^9, 3.7556908838209*^9}, {
   3.755690947832458*^9, 3.755690948056169*^9}, 3.755690978135062*^9, {
   3.755691036718184*^9, 3.755691037289468*^9}, {3.7556911155978394`*^9, 
   3.755691127319682*^9}, 3.755691208358964*^9, {3.755691328131755*^9, 
   3.755691332429063*^9}, {3.755692257252434*^9, 3.7556923294505053`*^9}, {
   3.755692616025626*^9, 3.755692679281328*^9}, {3.7556931877708673`*^9, 
   3.7556932696641407`*^9}, {3.755693301784623*^9, 3.755693359747286*^9}, {
   3.755693391426508*^9, 3.7556934966035213`*^9}, {3.7556935636776648`*^9, 
   3.755693710364152*^9}, {3.755693744583562*^9, 3.755693791936552*^9}, 
   3.755693860984263*^9, {3.755693901046213*^9, 3.755693928373005*^9}, {
   3.755693960849197*^9, 3.7556940756005917`*^9}, {3.755694147212256*^9, 
   3.7556941504311113`*^9}, {3.755694186680937*^9, 3.755694196192999*^9}, {
   3.755694226562668*^9, 3.755694321230962*^9}, {3.755694415299811*^9, 
   3.755694487054721*^9}, {3.7556947474619627`*^9, 3.75569474812354*^9}, {
   3.7556947803433857`*^9, 3.7556949870138273`*^9}, {3.755695067899598*^9, 
   3.7556951124821053`*^9}, {3.7556951474883003`*^9, 3.755695181226927*^9}, {
   3.755695251014233*^9, 3.755695281865161*^9}, 3.7556956039503183`*^9, {
   3.755696054244093*^9, 3.7556960576639*^9}, {3.7557116269504967`*^9, 
   3.755711627357305*^9}, {3.7558422200074663`*^9, 3.75584224062967*^9}, {
   3.7558423154860687`*^9, 3.7558423562763023`*^9}, {3.7558424044291143`*^9, 
   3.75584240830475*^9}, {3.755842442816679*^9, 3.755842446267591*^9}, 
   3.756355168485661*^9, {3.756362897634959*^9, 3.7563628979318438`*^9}, {
   3.760203056486784*^9, 3.760203086993474*^9}, {3.760203120760667*^9, 
   3.760203123231694*^9}, {3.760203153806027*^9, 3.7602034098743963`*^9}, {
   3.760203592558844*^9, 3.76020360559414*^9}, {3.760204692086547*^9, 
   3.760204692294017*^9}, {3.76020473198455*^9, 3.7602047709825563`*^9}, {
   3.760204894348021*^9, 3.760205048995522*^9}, {3.760205085323793*^9, 
   3.760205155449204*^9}, {3.760205186494608*^9, 3.760205323649178*^9}, {
   3.760205357076993*^9, 3.7602053590654917`*^9}, {3.760205406990604*^9, 
   3.760205424970662*^9}, {3.760205457566577*^9, 3.760205457649769*^9}, {
   3.76020596315646*^9, 3.7602059981509323`*^9}, 3.760206040239191*^9, {
   3.760206257561459*^9, 3.760206289441078*^9}, {3.760206602813559*^9, 
   3.760206625773012*^9}, {3.760206656218567*^9, 3.760206752125293*^9}, {
   3.7602068081941433`*^9, 3.76020684021824*^9}, {3.760206874073344*^9, 
   3.760206890066016*^9}, {3.760207587545596*^9, 3.760207587782282*^9}, {
   3.760207940431302*^9, 3.760207959869277*^9}, {3.7602757271747932`*^9, 
   3.760275727508984*^9}, {3.760277206259761*^9, 3.76027720646066*^9}, {
   3.760277370721655*^9, 3.7602773728702297`*^9}, {3.760277439874284*^9, 
   3.7602774498862743`*^9}, {3.760277556886178*^9, 3.760277557374707*^9}, {
   3.760277646077901*^9, 3.760277666571488*^9}, {3.760277718994218*^9, 
   3.760277747798025*^9}, {3.760277802904698*^9, 3.760277809398128*^9}, {
   3.7602780457370443`*^9, 3.7602780565906773`*^9}, {3.7602782147710667`*^9, 
   3.760278214938509*^9}, {3.760278249916676*^9, 3.760278250167926*^9}, {
   3.7602785549424553`*^9, 3.760278569627866*^9}, {3.760278819177806*^9, 
   3.760278864895051*^9}, {3.760278895937941*^9, 3.760279045684642*^9}, {
   3.760279455100781*^9, 3.760279462659539*^9}, {3.760279498472713*^9, 
   3.760279499377603*^9}, {3.760279909627742*^9, 3.7602799309627237`*^9}, {
   3.7602945312651*^9, 3.7602945531523323`*^9}, {3.760296989903886*^9, 
   3.760296990207671*^9}, {3.7602970307002773`*^9, 3.760297031840439*^9}, {
   3.7602971695725307`*^9, 3.760297172093855*^9}, {3.760297228300264*^9, 
   3.7602972308619633`*^9}, {3.760297480385619*^9, 3.760297555832934*^9}, {
   3.760297679049511*^9, 3.7602977124764767`*^9}, {3.760297817630332*^9, 
   3.760297818241221*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"b6385a62-b333-4060-837a-367ee4c0c7c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Test", "Title",
 CellChangeTimes->{{3.753004789321641*^9, 3.753004801956513*^9}, {
  3.754568563354204*^9, 
  3.754568564584738*^9}},ExpressionUUID->"d29cdb11-54e5-4def-9b8d-\
bb53683b8ea8"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Chi]", "2"], TraditionalForm]],ExpressionUUID->
  "57d89d36-2209-41dc-af4a-5f956a796df7"],
 " bez kowariancji"
}], "Section",
 CellChangeTimes->{
  3.754569927117038*^9},ExpressionUUID->"3c398db3-c6d5-4bed-b98f-\
786d0d09cab2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"newVanillaMatrix", "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"mecDist", ".", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"1", ",", 
          SuperscriptBox["mecDim", "2"]}], "]"}]}], ",", "12"}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "=", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{
       "danielVanillaMatrix", "-", "nonmecVanillaMatrix", "-", 
        "newVanillaMatrix"}], "errorVanillaMatrixError"], ")"}], "2"]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Chi]", "=", 
  RowBox[{"Total", "[", 
   RowBox[{"x", ",", "2"}], "]"}], "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.753004824796289*^9, 3.753004833028655*^9}, {
   3.7530048659077063`*^9, 3.753004866626156*^9}, {3.7530438581266623`*^9, 
   3.753043883657776*^9}, {3.753044303936296*^9, 3.753044328637476*^9}, {
   3.753044428593438*^9, 3.7530444305534773`*^9}, {3.753044460996306*^9, 
   3.753044509332934*^9}, {3.753044571527046*^9, 3.753044660765285*^9}, {
   3.753044721846586*^9, 3.753044729798015*^9}, {3.753055594859844*^9, 
   3.7530556044551697`*^9}, {3.7531314244591017`*^9, 3.753131425261508*^9}, {
   3.754568592353169*^9, 3.7545685927190638`*^9}, 3.754568658814527*^9, 
   3.7545694178081284`*^9, 3.7546715493508368`*^9, {3.7546715866976357`*^9, 
   3.754671591301599*^9}, {3.755017845644203*^9, 3.755017859939148*^9}, {
   3.755018005771084*^9, 3.755018006555625*^9}, {3.7602769921611567`*^9, 
   3.7602770272681828`*^9}, 3.7602771747722473`*^9, {3.7602779288754473`*^9, 
   3.760277930698271*^9}, {3.760277977435416*^9, 3.760278030536446*^9}, {
   3.7602780616651087`*^9, 3.760278183855698*^9}, {3.760278219375228*^9, 
   3.760278221627473*^9}, {3.7602782874446487`*^9, 3.760278314814145*^9}, {
   3.760278357953395*^9, 3.760278455464901*^9}, {3.7602785789803047`*^9, 
   3.760278790746992*^9}, 3.760278998497159*^9, {3.760279057917186*^9, 
   3.760279059464341*^9}, {3.760297096293832*^9, 3.7602971318349113`*^9}, {
   3.7602973955887327`*^9, 3.760297417964686*^9}, {3.760297462006625*^9, 
   3.7602974622054443`*^9}, {3.760297822536021*^9, 3.7602978264776983`*^9}, {
   3.7602978691882763`*^9, 3.760297943592799*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"d450b858-3609-4336-98e1-6c03910dfa58"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Chi]", "2"], TraditionalForm]],ExpressionUUID->
  "e6779c85-df6f-4e48-b1bc-09bff39e825f"],
 " z kowariancj\:0105"
}], "Section",
 CellChangeTimes->{
  3.754569939177436*^9, {3.754569978824548*^9, 
   3.7545699860660877`*^9}},ExpressionUUID->"b76d2729-e515-41a6-806f-\
24a5d790b232"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newVanillaMatrix", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"mecDist", ".", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", 
         SuperscriptBox["mecDim", "2"]}], "]"}]}], ",", "12"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{
     "danielVanillaMatrix", "-", "nonmecVanillaMatrix", "-", 
      "newVanillaMatrix"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"a", ".", "covVanilla", ".", "a"}]}], "Input",
 CellChangeTimes->{{3.760279128428371*^9, 3.760279280072418*^9}, {
  3.7602793142864428`*^9, 3.760279324551216*^9}, {3.760279421408045*^9, 
  3.760279438900383*^9}, {3.760279520595811*^9, 3.7602795987622538`*^9}, {
  3.760279805075534*^9, 3.7602799057749577`*^9}, {3.760297144185203*^9, 
  3.7602971871752357`*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"154c47e3-be1f-47f0-ab1c-f57ed6e273aa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Rozwi\:0105zanie", "Title",
 CellChangeTimes->{{3.7499234702376213`*^9, 3.7499234749543753`*^9}, 
   3.753071440733341*^9, {3.754568727822308*^9, 
   3.754568730941935*^9}},ExpressionUUID->"6f4892f4-63ff-495f-b8ce-\
8d3a8b8af5e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"emptyValue", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      SubscriptBox["v", 
       RowBox[{"i", ",", "j"}]], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "mecDim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "mecDim"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V1", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      SubscriptBox["v", 
       RowBox[{"i", ",", "j"}]], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "mecDim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "i", ",", "mecDim"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      SubscriptBox["v", 
       RowBox[{"i", ",", "j"}]], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2", ",", "mecDim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V3", "=", 
    RowBox[{"V", "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"V2", "\[Rule]", "emptyValue"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chi2", "[", "x_", "]"}], ":=", 
   RowBox[{"Total", "[", "\[IndentingNewLine]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"danielVanillaMatrix", "-", "nonmecVanillaMatrix", "-", 
          RowBox[{"Transpose", "@", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"mecDist", ".", "x"}], ",", "12"}], "]"}]}]}], ")"}], 
        "/", "errorVanillaMatrixError"}], ")"}], "2"], ",", "2"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chi2cov", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"danielVanillaMatrix", "-", "nonmecVanillaMatrix", "-", 
        RowBox[{"Transpose", "@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"mecDist", ".", "x"}], ",", "12"}], "]"}]}]}], "]"}], 
      "]"}], ")"}], ".", "covVanilla", ".", 
    RowBox[{"(", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"danielVanillaMatrix", "-", "nonmecVanillaMatrix", "-", 
        RowBox[{"Transpose", "@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"mecDist", ".", "x"}], ",", "12"}], "]"}]}]}], "]"}], 
      "]"}], ")"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotMec", "[", 
    RowBox[{"x_", ",", "fun_"}], "]"}], ":=", 
   RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"x", ",", "mecDim"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DataReversed", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubsuperscriptBox[\(\[Chi]\), \(cov\), \(2\)]\) = \>\"", "<>",
         " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"chi2cov", "[", "x", "]"}], "]"}], "<>", 
        "\"\< ,\!\(\*SubsuperscriptBox[\(\[Chi]\), \(non\), \(2\)]\) = \>\"", 
        " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"chi2", "[", "x", "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"condition", "[", "p_", "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"V1", "\[GreaterEqual]", " ", "0"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"Abs", "[", 
                RowBox[{
                 SubscriptBox["v", 
                  RowBox[{"i", ",", "j"}]], "-", 
                 SubscriptBox["v", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "1"}]}]]}], "]"}], 
               RowBox[{
                SubscriptBox["v", 
                 RowBox[{"i", ",", "j"}]], "+", 
                SubscriptBox["v", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "+", "1"}]}]]}]], "<", "p"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "mecDim"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "i", ",", 
               RowBox[{"mecDim", "-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"Abs", "[", 
                RowBox[{
                 SubscriptBox["v", 
                  RowBox[{"i", ",", "j"}]], "-", 
                 SubscriptBox["v", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "j"}]]}], "]"}], 
               RowBox[{
                SubscriptBox["v", 
                 RowBox[{"i", ",", "j"}]], "+", 
                SubscriptBox["v", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "j"}]]}]], "<", "p"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "mecDim"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"And", "@@", "a"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minChi2", "[", 
   RowBox[{"fun_", ",", "p_", ",", 
    RowBox[{"iter_:", "10"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "meth"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"meth", "=", "\"\<InteriorPoint\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "=", 
      RowBox[{"NMinimize", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fun", "[", "V3", "]"}], ",", 
          RowBox[{"condition", "[", "p", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "V1", ",", "\[IndentingNewLine]", 
        RowBox[{"MaxIterations", "\[Rule]", "iter"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"AccuracyGoal", "\[Rule]", "2"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<RandomSearch\>\"", ",", 
           RowBox[{"\"\<SearchPoints\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<RandomSeed\>\"", "\[Rule]", " ", 
            RowBox[{"RandomInteger", "[", "1000", "]"}]}], ",", 
           RowBox[{"Method", "\[Rule]", "meth"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StepMonitor", "\[RuleDelayed]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"path", "<>", "\"\</chi2Values/\>\"", "<>", 
              RowBox[{"ToString", "[", "fun", "]"}], "<>", "\"\<_\>\"", "<>", 
              
              RowBox[{"ToString", "[", 
               RowBox[{"fun", "[", "V3", "]"}], "]"}], "<>", 
              "\"\<_maxIter_\>\"", "<>", 
              RowBox[{"ToString", "[", "iter", "]"}], "<>", 
              "\"\<_continuous_\>\"", "<>", 
              RowBox[{"ToString", "[", "p", "]"}], "<>", "\"\<_\>\"", "<>", 
              "meth", "<>", "\"\<.dat\>\""}], ",", 
             RowBox[{"Partition", "[", 
              RowBox[{"V3", ",", "mecDim"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"plotMec", "[", 
             RowBox[{"V3", ",", "fun"}], "]"}], "]"}]}], ")"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"chi2", "[", 
       RowBox[{"V3", "/.", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7499234892423353`*^9, 3.749923587488476*^9}, {
   3.749923732669587*^9, 3.749923741103211*^9}, {3.749923793679389*^9, 
   3.749923795895557*^9}, {3.749923837170917*^9, 3.749923841406004*^9}, {
   3.749923892580977*^9, 3.74992391228584*^9}, {3.749924120602784*^9, 
   3.749924134235428*^9}, {3.749924294143794*^9, 3.7499243170560637`*^9}, {
   3.749924401422598*^9, 3.749924523801907*^9}, 3.749924570311284*^9, {
   3.749924600427443*^9, 3.749924601617866*^9}, {3.749924709212566*^9, 
   3.74992471000951*^9}, {3.749924833445207*^9, 3.749924899187771*^9}, {
   3.7499250326351347`*^9, 3.749925036001494*^9}, {3.7499255835747957`*^9, 
   3.7499255857995777`*^9}, 3.750093673583995*^9, {3.75009374876895*^9, 
   3.7500937639786463`*^9}, {3.750093801453911*^9, 3.750093833660178*^9}, {
   3.750093868689848*^9, 3.7500938834811783`*^9}, {3.750093966547961*^9, 
   3.7500941341509027`*^9}, {3.750094185860021*^9, 3.750094199314019*^9}, {
   3.7500942401032248`*^9, 3.750094266167596*^9}, {3.750094301372198*^9, 
   3.750094301744681*^9}, {3.750094419872222*^9, 3.750094421488264*^9}, {
   3.750095258792561*^9, 3.750095308842918*^9}, {3.750095431501894*^9, 
   3.750095509297577*^9}, {3.750095539938192*^9, 3.750095544720707*^9}, {
   3.7500956393811073`*^9, 3.7500956669910507`*^9}, {3.750095717493512*^9, 
   3.75009573323061*^9}, {3.75009664063137*^9, 3.7500966408662252`*^9}, {
   3.75009667855761*^9, 3.75009676556892*^9}, 3.750097068273518*^9, {
   3.750097160098227*^9, 3.7500972059028597`*^9}, {3.75009733847584*^9, 
   3.7500973580874777`*^9}, {3.750097519289565*^9, 3.750097551635538*^9}, {
   3.750097771560423*^9, 3.7500977826894703`*^9}, {3.750098302451829*^9, 
   3.75009835836373*^9}, {3.750172500457964*^9, 3.7501725518320303`*^9}, {
   3.7501761419854097`*^9, 3.750176350180387*^9}, {3.750176593514769*^9, 
   3.7501766201275*^9}, {3.750176674069585*^9, 3.750176720872078*^9}, {
   3.7501770104561996`*^9, 3.7501770160889177`*^9}, {3.7501770467777767`*^9, 
   3.75017705433783*^9}, {3.7501770952703867`*^9, 3.7501771162735147`*^9}, {
   3.75017714854978*^9, 3.750177226512178*^9}, {3.750177282160575*^9, 
   3.750177307612296*^9}, 3.750177822705587*^9, {3.750177859829653*^9, 
   3.7501778786400337`*^9}, {3.750177922827529*^9, 3.750177969086439*^9}, {
   3.75017816148203*^9, 3.7501782393363867`*^9}, 3.750178285991809*^9, {
   3.75017831688155*^9, 3.750178330166877*^9}, {3.7501787151197367`*^9, 
   3.750178750060747*^9}, 3.750178808835227*^9, {3.7501790072632637`*^9, 
   3.750179019781877*^9}, {3.7501794448793793`*^9, 3.750179490051998*^9}, {
   3.7501806022909737`*^9, 3.750180771015438*^9}, {3.750180806330632*^9, 
   3.75018090119271*^9}, {3.750182046996149*^9, 3.750182063261009*^9}, {
   3.75018224961734*^9, 3.750182340333928*^9}, 3.7501824825307827`*^9, {
   3.750182902173519*^9, 3.750182934361659*^9}, {3.750182984246344*^9, 
   3.750183046441688*^9}, {3.7501832038103027`*^9, 3.7501832291518*^9}, {
   3.7501832624813623`*^9, 3.750183264157083*^9}, {3.7503289785841103`*^9, 
   3.750328979165387*^9}, {3.7503290382028313`*^9, 3.750329043258624*^9}, {
   3.7503290740002613`*^9, 3.750329138287057*^9}, {3.750329416390971*^9, 
   3.750329421426065*^9}, {3.750329464741777*^9, 3.750329585814883*^9}, {
   3.750329621082082*^9, 3.750329716835273*^9}, {3.750330194161735*^9, 
   3.7503301976328907`*^9}, {3.7503310361896267`*^9, 3.750331040799734*^9}, {
   3.7503310709110327`*^9, 3.750331110319894*^9}, {3.750331433241746*^9, 
   3.75033150637461*^9}, {3.750331544695796*^9, 3.750331554125626*^9}, 
   3.750331698274787*^9, {3.7503321392130613`*^9, 3.75033215469942*^9}, 
   3.750332999990376*^9, {3.750333398190814*^9, 3.750333449095742*^9}, 
   3.750335699821393*^9, 3.750338561479599*^9, {3.750339255396851*^9, 
   3.750339328567672*^9}, {3.750339691724156*^9, 3.750339692700347*^9}, 
   3.750339756158977*^9, {3.750524079127592*^9, 3.7505240804922037`*^9}, {
   3.750524527417781*^9, 3.750524535941338*^9}, {3.750525116239792*^9, 
   3.750525134138542*^9}, 3.7505252564560757`*^9, {3.750525305309708*^9, 
   3.750525375255818*^9}, {3.750526899686389*^9, 3.7505268999755497`*^9}, {
   3.750527152299746*^9, 3.750527214943143*^9}, {3.7505273366597958`*^9, 
   3.75052737077291*^9}, 3.751044185101242*^9, {3.751045478138237*^9, 
   3.751045517541946*^9}, {3.751045707788663*^9, 3.7510457178670483`*^9}, {
   3.7512153358310747`*^9, 3.751215348909053*^9}, {3.751215471705236*^9, 
   3.751215567487673*^9}, {3.751215731705575*^9, 3.751215746792058*^9}, {
   3.75121666937316*^9, 3.7512166851473703`*^9}, {3.751216874864299*^9, 
   3.7512168775405807`*^9}, 3.751219245223874*^9, {3.751219391949163*^9, 
   3.751219394049419*^9}, {3.751219505977674*^9, 3.751219508677206*^9}, 
   3.752515715451489*^9, {3.752601011609145*^9, 3.752601027775124*^9}, {
   3.75260313337143*^9, 3.7526031354140673`*^9}, {3.7526042630368557`*^9, 
   3.7526043121746902`*^9}, 3.7527948641997128`*^9, {3.752876406827208*^9, 
   3.752876410401703*^9}, {3.7528769591424303`*^9, 3.75287697142313*^9}, {
   3.7528804570312223`*^9, 3.7528804812374277`*^9}, {3.752916250605685*^9, 
   3.7529163087786093`*^9}, {3.7529174668032627`*^9, 3.752917484962309*^9}, 
   3.752917574233232*^9, {3.752919138387439*^9, 3.752919176604536*^9}, {
   3.752919621950718*^9, 3.752919624091427*^9}, {3.752919654880579*^9, 
   3.7529196579159117`*^9}, 3.752958045430995*^9, 3.752958468011574*^9, {
   3.7529609747081747`*^9, 3.752960988836186*^9}, {3.7529613887644567`*^9, 
   3.7529614235449257`*^9}, {3.752989097784232*^9, 3.75298909829009*^9}, {
   3.753004002468821*^9, 3.753004003273576*^9}, {3.753004745489896*^9, 
   3.7530047571711187`*^9}, {3.7530056849597588`*^9, 
   3.7530057214285297`*^9}, {3.753005995403454*^9, 3.753006010027185*^9}, {
   3.753006299459001*^9, 3.7530063132158318`*^9}, {3.7530063644409523`*^9, 
   3.753006390839278*^9}, {3.7530083812991533`*^9, 3.753008447373328*^9}, {
   3.753045091272087*^9, 3.753045109085421*^9}, 3.7530453626292267`*^9, 
   3.753045610739869*^9, 3.7530463544943743`*^9, 3.753047002522601*^9, {
   3.753054315713809*^9, 3.753054320730541*^9}, {3.753054358286024*^9, 
   3.753054367764784*^9}, 3.753055617036934*^9, 3.753055659490286*^9, 
   3.7530563191006403`*^9, 3.753056432756081*^9, 3.75305654608844*^9, {
   3.75305658244072*^9, 3.7530566073713713`*^9}, 3.75307159671205*^9, {
   3.7530716848241367`*^9, 3.753071701717791*^9}, {3.753071759656639*^9, 
   3.753071759838709*^9}, {3.753071825638152*^9, 3.753071859278225*^9}, {
   3.7530719225915747`*^9, 3.7530719503278522`*^9}, {3.753072042912752*^9, 
   3.753072104534794*^9}, {3.75307216164918*^9, 3.753072194447916*^9}, {
   3.7530722604794083`*^9, 3.753072264126563*^9}, 3.753072377054001*^9, {
   3.75307248631689*^9, 3.7530724870410147`*^9}, {3.753072593550754*^9, 
   3.753072623794773*^9}, {3.753073054080515*^9, 3.7530731024485073`*^9}, {
   3.753074456545472*^9, 3.753074483605173*^9}, {3.7530766539610643`*^9, 
   3.7530766742522383`*^9}, {3.753087272485898*^9, 3.753087285648942*^9}, {
   3.753088751257592*^9, 3.753088767820382*^9}, {3.753088805941135*^9, 
   3.753088806144212*^9}, {3.7530889523202677`*^9, 3.753088954043041*^9}, {
   3.753089737957736*^9, 3.753089778106801*^9}, 3.75308984665949*^9, 
   3.753090116767117*^9, 3.753090333284583*^9, {3.75309107154331*^9, 
   3.753091079283072*^9}, {3.753092117875311*^9, 3.7530921227149267`*^9}, {
   3.7530945426424923`*^9, 3.753094542799329*^9}, {3.753094645003262*^9, 
   3.7530946555678043`*^9}, 3.7530948574970293`*^9, {3.753095151276366*^9, 
   3.753095151421591*^9}, {3.753095185047676*^9, 3.753095306256776*^9}, {
   3.753095496533227*^9, 3.7530955512704277`*^9}, {3.753096066270544*^9, 
   3.7530961104242764`*^9}, {3.753096155945696*^9, 3.753096164357873*^9}, 
   3.753096196743894*^9, {3.753131449706921*^9, 3.75313146337416*^9}, {
   3.753138047600005*^9, 3.753138048123249*^9}, {3.7531382101529417`*^9, 
   3.753138217584381*^9}, {3.753152505872559*^9, 3.7531525119020452`*^9}, {
   3.7531555039702463`*^9, 3.753155506011895*^9}, {3.754061116691228*^9, 
   3.75406114090871*^9}, {3.75406123049533*^9, 3.754061278639781*^9}, {
   3.754061615744245*^9, 3.754061629238268*^9}, {3.7540618632957153`*^9, 
   3.754061981254476*^9}, {3.754062094108753*^9, 3.754062095480257*^9}, {
   3.754062195179697*^9, 3.754062198856966*^9}, {3.7540623870236607`*^9, 
   3.754062557184578*^9}, 3.754063616940887*^9, 3.754063648840982*^9, {
   3.754063920784315*^9, 3.754063982600849*^9}, {3.754064068449161*^9, 
   3.754064103749291*^9}, {3.754064197402388*^9, 3.754064271476822*^9}, {
   3.754064447770712*^9, 3.754064449022008*^9}, {3.754064718855051*^9, 
   3.754064732992571*^9}, {3.7540647969876547`*^9, 3.754064821630451*^9}, {
   3.75406510663175*^9, 3.7540651073545513`*^9}, {3.7543216266630497`*^9, 
   3.7543216655013*^9}, {3.754321695668727*^9, 3.754321861841324*^9}, 
   3.7543218973513823`*^9, {3.7543219627816257`*^9, 3.754322003278223*^9}, {
   3.754322144620111*^9, 3.7543221821991987`*^9}, {3.754322216880332*^9, 
   3.754322217142157*^9}, {3.754322527755788*^9, 3.754322619828225*^9}, {
   3.754322678657304*^9, 3.754322708099394*^9}, {3.754322835936686*^9, 
   3.754322955008821*^9}, {3.75432299763513*^9, 3.7543230179765987`*^9}, {
   3.754323094163907*^9, 3.754323105987344*^9}, {3.75432314692248*^9, 
   3.754323196455041*^9}, {3.754323439432975*^9, 3.754323451283189*^9}, {
   3.7543235651742573`*^9, 3.7543235685455103`*^9}, {3.754323766288261*^9, 
   3.7543237822231617`*^9}, {3.754323854019293*^9, 3.75432385647441*^9}, 
   3.7543240239438887`*^9, {3.75432423295748*^9, 3.754324233137643*^9}, {
   3.754325627953534*^9, 3.754325667220986*^9}, {3.754326612667973*^9, 
   3.754326623202998*^9}, {3.7543266557957687`*^9, 3.7543266788999968`*^9}, {
   3.7543267134446907`*^9, 3.754326718801874*^9}, {3.754326752714427*^9, 
   3.754326752820483*^9}, 3.754327632210269*^9, 3.754333864229764*^9, {
   3.754499440325706*^9, 3.7544994684706373`*^9}, {3.754499501614894*^9, 
   3.7544995282299623`*^9}, {3.754499588684307*^9, 3.75449965915889*^9}, {
   3.7544996897976837`*^9, 3.754499790418894*^9}, {3.754500419538155*^9, 
   3.754500459305429*^9}, {3.7545005061034603`*^9, 3.754500514602913*^9}, {
   3.754550675394882*^9, 3.754550675534844*^9}, 3.75455636838941*^9, {
   3.754556568611775*^9, 3.754556578642253*^9}, 3.754557004001927*^9, {
   3.754557067502521*^9, 3.754557141663171*^9}, {3.754568756551016*^9, 
   3.754568756816215*^9}, {3.7545688151213017`*^9, 3.75456891005241*^9}, {
   3.7545689411167517`*^9, 3.754569086950594*^9}, {3.754569143581997*^9, 
   3.754569144580742*^9}, {3.754569218245482*^9, 3.754569248516644*^9}, {
   3.754569281399127*^9, 3.754569400581752*^9}, {3.754569432585782*^9, 
   3.754569451828094*^9}, {3.7545695400566587`*^9, 3.75456956443825*^9}, {
   3.754569878639049*^9, 3.754569880106062*^9}, {3.754570127775214*^9, 
   3.754570150228342*^9}, {3.754570469411829*^9, 3.75457049845327*^9}, {
   3.754570532381093*^9, 3.754570570637416*^9}, {3.75457062376495*^9, 
   3.75457062393526*^9}, {3.754570678448019*^9, 3.7545706797110662`*^9}, {
   3.754570722361567*^9, 3.754570754657074*^9}, {3.754570901488028*^9, 
   3.754570913528161*^9}, {3.7545711898847933`*^9, 3.754571198915287*^9}, {
   3.7545714320484447`*^9, 3.754571439710146*^9}, 3.754571661711009*^9, {
   3.754571706093998*^9, 3.754571753098057*^9}, {3.754571874034053*^9, 
   3.754571876665798*^9}, {3.754571944488899*^9, 3.754572000130735*^9}, {
   3.754572873665328*^9, 3.7545729346262693`*^9}, {3.7545730141796513`*^9, 
   3.754573017210864*^9}, {3.754574173906013*^9, 3.754574223308766*^9}, {
   3.754575036086244*^9, 3.754575036234171*^9}, {3.754577461932754*^9, 
   3.754577470322538*^9}, {3.7545777721768913`*^9, 3.754577793168901*^9}, {
   3.754580101446001*^9, 3.754580110983449*^9}, {3.754581110964221*^9, 
   3.7545811137565613`*^9}, 3.754588226383374*^9, {3.75467056276756*^9, 
   3.754670589062027*^9}, {3.7546706297216988`*^9, 3.75467063998908*^9}, {
   3.7546730134306393`*^9, 3.75467301639572*^9}, {3.7546746821908817`*^9, 
   3.754674683514103*^9}, {3.754845680029202*^9, 3.7548456946761312`*^9}, {
   3.754847841377553*^9, 3.7548478417254467`*^9}, {3.7550168509988127`*^9, 
   3.755016851626844*^9}, {3.755016955531719*^9, 3.7550169579830236`*^9}, {
   3.755017579391708*^9, 3.7550176054619427`*^9}, {3.755020370607445*^9, 
   3.755020375145404*^9}, {3.755021983326769*^9, 3.75502204578489*^9}, {
   3.755022134758583*^9, 3.755022135198929*^9}, {3.755022234125114*^9, 
   3.755022238998859*^9}, {3.755022483974091*^9, 3.755022499988186*^9}, {
   3.755026495062242*^9, 3.755026499908248*^9}, {3.7550268507412167`*^9, 
   3.755026865174358*^9}, {3.755104153645331*^9, 3.75510415729427*^9}, {
   3.755360756681179*^9, 3.7553607696510773`*^9}, {3.755360860033997*^9, 
   3.755360881002922*^9}, 3.755627660874978*^9, {3.755627881421535*^9, 
   3.7556279014856997`*^9}, {3.7556281413973217`*^9, 3.755628141701874*^9}, {
   3.755628463213162*^9, 3.755628465439083*^9}, {3.755628792191214*^9, 
   3.755628793010405*^9}, {3.755628888617015*^9, 3.755628899971236*^9}, {
   3.755629039869664*^9, 3.755629039978849*^9}, {3.755629132679867*^9, 
   3.755629267530862*^9}, {3.755631132184774*^9, 3.755631136652855*^9}, {
   3.7556326708708763`*^9, 3.755632673054688*^9}, {3.755632705909924*^9, 
   3.755632729694687*^9}, {3.755711651998591*^9, 3.7557116687492332`*^9}, 
   3.75571691864316*^9, 3.7557169597207613`*^9, {3.755717012116147*^9, 
   3.7557170663039703`*^9}, {3.755717202907646*^9, 3.755717225166007*^9}, 
   3.7557173037998734`*^9, {3.755717839441059*^9, 3.755717843252397*^9}, 
   3.7557181901775627`*^9, {3.7557182573766336`*^9, 3.7557183019725523`*^9}, {
   3.7557186399468727`*^9, 3.755718657529883*^9}, 3.7557187940492887`*^9, 
   3.755786729126521*^9, {3.7557901396833353`*^9, 3.7557901677900953`*^9}, {
   3.755790200521833*^9, 3.755790205134997*^9}, 3.7557902901242113`*^9, {
   3.755790424004294*^9, 3.755790424130143*^9}, {3.7557905953725023`*^9, 
   3.755790595532733*^9}, {3.756355273590679*^9, 3.7563552894840508`*^9}, {
   3.756355336155405*^9, 3.7563553843255033`*^9}, {3.75635543529125*^9, 
   3.756355458774509*^9}, {3.756355512141554*^9, 3.756355518869728*^9}, {
   3.756355550214275*^9, 3.756355566101653*^9}, {3.7563557871572857`*^9, 
   3.756355799723797*^9}, {3.756356340603362*^9, 3.756356343276313*^9}, {
   3.756358174133931*^9, 3.756358188516995*^9}, {3.7563622449971848`*^9, 
   3.756362250277749*^9}, {3.7563649028314323`*^9, 3.756364992325495*^9}, {
   3.756448351104906*^9, 3.75644836806619*^9}, {3.7566205124031*^9, 
   3.756620512569854*^9}, {3.756620563877347*^9, 3.756620566628381*^9}, {
   3.758093174625613*^9, 3.7580931783999033`*^9}, {3.758093230467371*^9, 
   3.758093268032756*^9}, {3.7580934449494543`*^9, 3.758093448854045*^9}, {
   3.758093485551589*^9, 3.758093486596962*^9}, {3.7580940953149033`*^9, 
   3.758094097473152*^9}, {3.758099379235013*^9, 3.758099383022214*^9}, 
   3.7580997639449577`*^9, {3.758099827912588*^9, 3.758099849660953*^9}, 
   3.758100170284873*^9, {3.758100316891906*^9, 3.7581003259266043`*^9}, {
   3.7581006036650677`*^9, 3.758100640594105*^9}, {3.758106720426889*^9, 
   3.75810672563855*^9}, 3.758107069196437*^9, 3.758126500218885*^9, {
   3.758170723431116*^9, 3.75817072970217*^9}, {3.758170766978239*^9, 
   3.758170768876252*^9}, {3.758171378698183*^9, 3.758171381259508*^9}, {
   3.758174044287841*^9, 3.758174056790524*^9}, {3.758175474677597*^9, 
   3.7581755023139467`*^9}, {3.758176635362733*^9, 3.758176637547207*^9}, {
   3.758184637596874*^9, 3.7581846693970118`*^9}, {3.7581857576787243`*^9, 
   3.75818582755049*^9}, {3.75819107169795*^9, 3.7581910771512203`*^9}, {
   3.758194372804208*^9, 3.758194376917399*^9}, 3.7581948224636793`*^9, {
   3.75821107003411*^9, 3.758211074222397*^9}, {3.758360892209091*^9, 
   3.758360949313581*^9}, {3.758517715591977*^9, 3.758517722618153*^9}, 
   3.758533890970949*^9, 3.758611241842223*^9, 3.758616507268029*^9, 
   3.7586253293089123`*^9, 3.758634070480895*^9, 3.7586513439206457`*^9, 
   3.758693314015747*^9, {3.758725494269006*^9, 3.7587255033313723`*^9}, {
   3.759839498488674*^9, 3.759839502972734*^9}, 3.7600068941434517`*^9, {
   3.760280012616191*^9, 3.7602800660685673`*^9}, {3.760280130359543*^9, 
   3.7602801526155167`*^9}, {3.7602945671995487`*^9, 3.760294567886464*^9}, {
   3.760294725224615*^9, 
   3.7602947262433043`*^9}},ExpressionUUID->"d127c4c4-244f-47f4-874b-\
a70d32e2a23d"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["\[Chi]", "2"], " ", "z", " ", "kowariancj\:0105"}], 
  TraditionalForm]],ExpressionUUID->"a390c350-7f38-4f7a-bf89-5343791ba53e"]], \
"Section",
 CellChangeTimes->{{3.754569842998272*^9, 3.754569858197824*^9}, {
  3.756355919250773*^9, 
  3.756355924741803*^9}},ExpressionUUID->"324638f4-ec90-47b7-884d-\
1dc0b3092bbe"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Chi]", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ecadbde0-94ab-4de0-bb27-1efa31f5d8a6"],
 " vs continuity parameter"
}], "Subsection",
 CellChangeTimes->{{3.758211010930442*^9, 3.758211018341395*^9}, {
  3.760294447208193*^9, 
  3.760294481810028*^9}},ExpressionUUID->"3ebf8b6e-5d68-485f-a291-\
e56ff227ba06"],

Cell[BoxData[{
 RowBox[{"list", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"minChi2", "[", 
        RowBox[{"chi2cov", ",", "#", ",", "100"}], "]"}], ",", "#"}], "}"}], 
     "]"}], "&"}], "/@", 
   RowBox[{"Range", "[", 
    RowBox[{"0.05", ",", "0.95", ",", "0.1"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"path", "<>", "\"\</chi2_vs_con_InteriorPoint_100.dat\>\""}], ",",
     "%"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.758211109854021*^9, 3.7582111272015743`*^9}, {
   3.758211184052514*^9, 3.7582111863432302`*^9}, {3.758211503304365*^9, 
   3.758211505313491*^9}, {3.758214344385689*^9, 3.75821434463803*^9}, {
   3.7582174078328123`*^9, 3.758217431107383*^9}, {3.758273051032999*^9, 
   3.758273055461179*^9}, {3.75827571917213*^9, 3.758275729550126*^9}, 
   3.7582866454691973`*^9, {3.758518611224869*^9, 3.7585186466966887`*^9}, {
   3.7585222935386066`*^9, 3.758522299836097*^9}, 3.760294376860345*^9, {
   3.760294406970001*^9, 3.760294436969883*^9}},
 CellLabel->
  "In[888]:=",ExpressionUUID->"b511eef5-173b-4945-bddd-04bc1bbf5348"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listCov", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", "#", "]"}], "&"}], "/@", "list"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listNonCov", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Last", "[", "#", "]"}], "&"}], "/@", "list"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "%", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "%%%", "]"}]}], "Input",
 CellChangeTimes->{{3.7582502357761517`*^9, 3.7582502374074*^9}, {
  3.758250285265517*^9, 3.758250291935994*^9}, {3.758251340842256*^9, 
  3.758251361379579*^9}, {3.7582514066990957`*^9, 3.758251465657968*^9}, {
  3.7582515597600927`*^9, 3.758251613767844*^9}, {3.758296853244156*^9, 
  3.758297078206958*^9}, {3.758297272367841*^9, 3.758297273059374*^9}, {
  3.758298065766341*^9, 3.758298137639504*^9}, {3.758518599455756*^9, 
  3.758518607785798*^9}, {3.758518659733184*^9, 3.7585186599126873`*^9}, {
  3.7585337958378563`*^9, 3.758533810674885*^9}, {3.758533845109874*^9, 
  3.758533858487007*^9}, {3.7588611542994423`*^9, 3.758861166663186*^9}, {
  3.758861226607636*^9, 3.758861251489999*^9}, {3.75896319656004*^9, 
  3.7589632638409224`*^9}, {3.7602943845244837`*^9, 3.76029439510783*^9}, {
  3.760294434524642*^9, 
  3.7602944354435673`*^9}},ExpressionUUID->"5a800db4-6c7a-4682-b314-\
9fbff271666e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normal", "Subsection",
 CellChangeTimes->{{3.758298169026622*^9, 3.758298172207581*^9}, {
  3.759839511697936*^9, 
  3.7598395121044617`*^9}},ExpressionUUID->"7eddd118-e3b5-447f-bd5b-\
f14ca4d90806"],

Cell[BoxData[
 RowBox[{"minChi2", "[", 
  RowBox[{"chi2cov", ",", "0.3", ",", "100"}], "]"}]], "Input",
 CellChangeTimes->{{3.7582981757064323`*^9, 3.758298217756482*^9}, {
   3.758517730728356*^9, 3.7585177309614162`*^9}, {3.758533878249392*^9, 
   3.758533878964449*^9}, 3.7586112513960342`*^9},
 CellLabel->
  "In[887]:=",ExpressionUUID->"b839cef5-8e7f-4a97-962a-6d4ac9512423"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. Plots of result", "Title",
 CellChangeTimes->{{3.7556953453697023`*^9, 
  3.7556953538242702`*^9}},ExpressionUUID->"19ae2f08-acf4-44a2-b31d-\
3dde8fd675f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"RectangleChart", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]p", "T"], ",", 
           RowBox[{"Take", "[", 
            RowBox[{"totalVanilla", ",", 
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"-", "1"}], ",", "lenPL"}], "}"}]}], "]"}]}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BarSpacing", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "->", "Full"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ChartStyle", "\[Rule]", "Yellow"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{
         "\"\<CC 0\[Pi] \!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\), NuWro \
before rescaling, \>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"dpL", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "]"}], "<>", 
          "\"\< < \!\(\*SubscriptBox[\(p\), \(L\)]\) < \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"dpL", "[", 
            RowBox[{"[", 
             RowBox[{"#", "+", "1"}], "]"}], "]"}], "]"}], " ", "<>", " ", 
          "\"\< [MeV], \!\(\*SubsuperscriptBox[\(\[Chi]\), \(cov\), \(2\)]\) \
= \>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"chi2cov", "[", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              SuperscriptBox["mecDim", "2"]}], "]"}], "]"}], "]"}]}]}], " ", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(p\), \(T\)]\) [MeV]\>\"", ",", 
           
           "\"\<cross section (per nucleon) [\!\(\*SuperscriptBox[\(cm\), \(2\
\)]\)/\!\(\*SuperscriptBox[\(GeV\), \(2\)]\)/nucleon]\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Background", "\[Rule]", "White"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "lenPL", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"RectangleChart", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]p", "T"], ",", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"totalVanilla", "-", "mecVanilla", "+", 
              RowBox[{"matVanilla", ".", 
               RowBox[{"Flatten", "[", "tmp", "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"-", "1"}], ",", "lenPL"}], "}"}]}], "]"}]}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BarSpacing", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"ChartStyle", "\[Rule]", "Green"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{
         "\"\<CC 0\[Pi] \!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\), NuWro \
after rescaling, \>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"dpL", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "]"}], "<>", 
          "\"\< < \!\(\*SubscriptBox[\(p\), \(L\)]\) < \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"dpL", "[", 
            RowBox[{"[", 
             RowBox[{"#", "+", "1"}], "]"}], "]"}], "]"}], " ", "<>", " ", 
          "\"\< [MeV], \!\(\*SubsuperscriptBox[\(\[Chi]\), \(cov\), \(2\)]\) \
= \>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"chi2cov", "[", 
            RowBox[{"Flatten", "[", "temp", "]"}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(p\), \(T\)]\) [MeV]\>\"", ",", 
           "\"\<cross section (per nucleon) [\!\(\*SuperscriptBox[\(cm\), \(2\
\)]\)/\!\(\*SuperscriptBox[\(GeV\), \(2\)]\)/nucleon]\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Background", "\[Rule]", "White"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "lenPL", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ListStepPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"dpT", ",", 
           RowBox[{"Take", "[", 
            RowBox[{"danielVanilla", ",", 
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"-", "1"}], ",", "lenPL"}], "}"}]}], "]"}]}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", "Left", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"#", "-", "1"}], ")"}]}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "lenPL", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"path", "<>", "\"\</histogramsBefore/\>\"", "<>", 
       RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"c", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "[", "lenPL", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"path", "<>", "\"\</histogramsAfter/\>\"", "<>", 
       RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"b", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"c", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "[", "lenPL", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.755695368742116*^9, 3.755695397014861*^9}, {
   3.755695571645652*^9, 3.7556955860253143`*^9}, {3.755695622159916*^9, 
   3.755695627091092*^9}, {3.7556957058173923`*^9, 3.755695734705566*^9}, {
   3.755695788450589*^9, 3.75569579790569*^9}, 3.755695832460416*^9, {
   3.7556960208731117`*^9, 3.755696394561028*^9}, {3.755696451587332*^9, 
   3.755696460460701*^9}, {3.755696532005307*^9, 3.7556966520143557`*^9}, {
   3.755696915438504*^9, 3.7556969546888323`*^9}, {3.755696999755065*^9, 
   3.755697041335298*^9}, 3.755697103712922*^9, {3.7556971678325567`*^9, 
   3.755697184344145*^9}, {3.755697260647152*^9, 3.7556972617920837`*^9}, {
   3.7556980207109957`*^9, 3.755698023222857*^9}, {3.755698070346147*^9, 
   3.755698074644993*^9}, {3.755698226686075*^9, 3.7556982855866203`*^9}, 
   3.755698317928486*^9, {3.755698377897838*^9, 3.755698428460225*^9}, {
   3.755698462966113*^9, 3.755698538580894*^9}, {3.755698587626506*^9, 
   3.75569860788481*^9}, {3.7556987522474747`*^9, 3.75569878369591*^9}, {
   3.7556988208411083`*^9, 3.755698862766375*^9}, {3.75569889911633*^9, 
   3.7556989169206963`*^9}, {3.755698990524741*^9, 3.755699089212852*^9}, {
   3.755699132701541*^9, 3.7556991569171543`*^9}, {3.7557628641429863`*^9, 
   3.7557629195345573`*^9}, {3.755762975858412*^9, 3.755763029591127*^9}, {
   3.756363302752844*^9, 
   3.75636330721347*^9}},ExpressionUUID->"c8eabb7d-d031-4e40-9f42-\
9bb8f1e17cfc"]
}, Closed]]
},
WindowSize->{933, 1021},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
WindowStatusArea->None,
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Landscape",
"PaperSize"->{842.25, 594.75},
"PostScriptOutputFile"->"/home/michaszko/print.pdf"},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 265, 4, 98, "Title",ExpressionUUID->"df3e8bd5-89f0-4c5c-b0ea-a847000923af"],
Cell[848, 28, 23161, 405, 1005, "Input",ExpressionUUID->"b6385a62-b333-4060-837a-367ee4c0c7c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24046, 438, 199, 4, 98, "Title",ExpressionUUID->"d29cdb11-54e5-4def-9b8d-bb53683b8ea8"],
Cell[CellGroupData[{
Cell[24270, 446, 290, 9, 68, "Section",ExpressionUUID->"3c398db3-c6d5-4bed-b98f-786d0d09cab2"],
Cell[24563, 457, 2476, 48, 207, "Input",ExpressionUUID->"d450b858-3609-4336-98e1-6c03910dfa58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27076, 510, 345, 10, 68, "Section",ExpressionUUID->"b76d2729-e515-41a6-806f-24a5d790b232"],
Cell[27424, 522, 1036, 25, 86, "Input",ExpressionUUID->"154c47e3-be1f-47f0-ab1c-f57ed6e273aa"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28509, 553, 239, 4, 98, "Title",ExpressionUUID->"6f4892f4-63ff-495f-b8ce-8d3a8b8af5e3"],
Cell[28751, 559, 25464, 464, 1302, "Input",ExpressionUUID->"d127c4c4-244f-47f4-874b-a70d32e2a23d"],
Cell[CellGroupData[{
Cell[54240, 1027, 386, 9, 68, "Section",ExpressionUUID->"324638f4-ec90-47b7-884d-1dc0b3092bbe"],
Cell[CellGroupData[{
Cell[54651, 1040, 407, 11, 55, "Subsection",ExpressionUUID->"3ebf8b6e-5d68-485f-a291-e56ff227ba06"],
Cell[55061, 1053, 1180, 27, 55, "Input",ExpressionUUID->"b511eef5-173b-4945-bddd-04bc1bbf5348"],
Cell[56244, 1082, 1358, 28, 101, "Input",ExpressionUUID->"5a800db4-6c7a-4682-b314-9fbff271666e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57639, 1115, 205, 4, 55, "Subsection",ExpressionUUID->"7eddd118-e3b5-447f-bd5b-f14ca4d90806"],
Cell[57847, 1121, 380, 7, 31, "Input",ExpressionUUID->"b839cef5-8e7f-4a97-962a-6d4ac9512423"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58288, 1135, 165, 3, 98, "Title",ExpressionUUID->"19ae2f08-acf4-44a2-b31d-3dde8fd675f3"],
Cell[58456, 1140, 8864, 202, 944, "Input",ExpressionUUID->"c8eabb7d-d031-4e40-9f42-9bb8f1e17cfc"]
}, Closed]]
}
]
*)

